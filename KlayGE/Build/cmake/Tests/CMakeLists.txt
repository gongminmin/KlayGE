DOWNLOAD_FILE("KlayGE/Tests/media/leaf_v3_green_tex.dds" "cbda47a1678ce70b6720856736100979d469e159" "c180e28392be0f6d9b8e429c416392923d9e7139")
DOWNLOAD_FILE("KlayGE/Tests/media/leaf_v3_green_tex_bc2.dds" "cbda47a1678ce70b6720856736100979d469e159" "8e957d446dabd5aaff0744b1ce33fb64fa005e78")
DOWNLOAD_FILE("KlayGE/Tests/media/leaf_v3_green_tex_bc3.dds" "cbda47a1678ce70b6720856736100979d469e159" "c4c759dca6745a24aceb9c9c6575016de774b95b")
DOWNLOAD_FILE("KlayGE/Tests/media/leaf_v3_green_tex_bc7.dds" "cbda47a1678ce70b6720856736100979d469e159" "a6469f9c8c2bbffb4493edcad7079aa52c29646b")
DOWNLOAD_FILE("KlayGE/Tests/media/Lenna.dds" "cbda47a1678ce70b6720856736100979d469e159" "292f31bcc45712989e1f3593835d5129bba8c0ac")
DOWNLOAD_FILE("KlayGE/Tests/media/Lenna_bc1.dds" "cbda47a1678ce70b6720856736100979d469e159" "1c236d9d06364fbeb03a274802b086d782a9609b")
DOWNLOAD_FILE("KlayGE/Tests/media/Lenna_bc7.dds" "cbda47a1678ce70b6720856736100979d469e159" "bac042f2692b1c30b1f681c5ed06edf9fa6e9007")
DOWNLOAD_FILE("KlayGE/Tests/media/memorial.dds" "cbda47a1678ce70b6720856736100979d469e159" "cee51491891a16bf5cc39eb1fd54fff0b0ae0683")
DOWNLOAD_FILE("KlayGE/Tests/media/memorial_bc6u.dds" "cbda47a1678ce70b6720856736100979d469e159" "23609a1794f2c95b643c12282728a9865988fc47")
DOWNLOAD_FILE("KlayGE/Tests/media/uffizi_probe.dds" "cbda47a1678ce70b6720856736100979d469e159" "f614b2494da0b649e0c14a2648213a3c95da8bcc")
DOWNLOAD_FILE("KlayGE/Tests/media/uffizi_probe_bc6s.dds" "cbda47a1678ce70b6720856736100979d469e159" "f3b28807c56a1c8b99d1fe8d831d6a653539abd1")

SET(SOURCE_FILES
	${KLAYGE_PROJECT_DIR}/Tests/src/CTHashTest.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/EncodeDecodeTexTest.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/KlayGETests.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/MathTest.cpp
	${KLAYGE_PROJECT_DIR}/Tests/src/SIMDMathTest.cpp
)
SET(HEADER_FILES "")
SET(RESOURCE_FILES "")
SET(EFFECT_FILES "")
SET(POST_PROCESSORS "")
SET(UI_FILES "")

SOURCE_GROUP("Source Files" FILES ${SOURCE_FILES})
SOURCE_GROUP("Header Files" FILES ${HEADER_FILES})
SOURCE_GROUP("Resource Files" FILES ${RESOURCE_FILES})
SOURCE_GROUP("Effect Files" FILES ${EFFECT_FILES})
SOURCE_GROUP("Post Processors" FILES ${POST_PROCESSORS})
SOURCE_GROUP("UI Files" FILES ${UI_FILES})

SET(EXE_NAME "Tests")

INCLUDE_DIRECTORIES(${Boost_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../KFL/include)
INCLUDE_DIRECTORIES(${KLAYGE_PROJECT_DIR}/Core/Include)
INCLUDE_DIRECTORIES(${EXTRA_INCLUDE_DIRS})
LINK_DIRECTORIES(${Boost_LIBRARY_DIR})
LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../KFL/lib/${KLAYGE_PLATFORM_NAME})
IF(KLAYGE_PLATFORM_DARWIN OR KLAYGE_PLATFORM_LINUX)
	LINK_DIRECTORIES(${KLAYGE_BIN_DIR})
ELSE()
	LINK_DIRECTORIES(${KLAYGE_OUTPUT_DIR})
ENDIF()
IF(KLAYGE_PLATFORM_ANDROID OR KLAYGE_PLATFORM_IOS)
	LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../glloader/lib/${KLAYGE_PLATFORM_NAME})
	LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../kfont/lib/${KLAYGE_PLATFORM_NAME})
	LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../MeshMLLib/lib/${KLAYGE_PLATFORM_NAME})
	LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../External/7z/lib/${KLAYGE_PLATFORM_NAME})
ENDIF()
LINK_DIRECTORIES(${EXTRA_LINKED_DIRS})

ADD_EXECUTABLE(${EXE_NAME} "" ${SOURCE_FILES} ${HEADER_FILES} ${RESOURCE_FILES} ${EFFECT_FILES} ${POST_PROCESSORS} ${UI_FILES})

SET_TARGET_PROPERTIES(${EXE_NAME} PROPERTIES
	PROJECT_LABEL ${EXE_NAME}
	DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX}
	OUTPUT_NAME ${EXE_NAME}${KLAYGE_OUTPUT_SUFFIX})

IF(KLAYGE_PLATFORM_DARWIN)
	SET_TARGET_PROPERTIES(${EXE_NAME} PROPERTIES
		RUNTIME_OUTPUT_DIRECTORY ${KLAYGE_BIN_DIR}
		RUNTIME_OUTPUT_DIRECTORY_DEBUG ${KLAYGE_BIN_DIR}
		RUNTIME_OUTPUT_DIRECTORY_RELEASE ${KLAYGE_BIN_DIR}
		RUNTIME_OUTPUT_DIRECTORY_RELWITHDEBINFO ${KLAYGE_BIN_DIR}
		RUNTIME_OUTPUT_DIRECTORY_MINSIZEREL ${KLAYGE_BIN_DIR}
	)
ENDIF()

IF(MSVC)
	SET(EXTRA_LINKED_LIBRARIES ${EXTRA_LINKED_LIBRARIES})
ELSE()
	SET(EXTRA_LINKED_LIBRARIES ${EXTRA_LINKED_LIBRARIES}
		debug KlayGE_Core${KLAYGE_OUTPUT_SUFFIX}_d optimized KlayGE_Core${KLAYGE_OUTPUT_SUFFIX}
		debug KFL${KLAYGE_OUTPUT_SUFFIX}_d optimized KFL${KLAYGE_OUTPUT_SUFFIX}
		${Boost_UNIT_TEST_FRAMEWORK_LIBRARY} ${Boost_SYSTEM_LIBRARY})
	IF(KLAYGE_PLATFORM_LINUX)
		SET(EXTRA_LINKED_LIBRARIES ${EXTRA_LINKED_LIBRARIES} dl pthread)
	ENDIF()
ENDIF()
ADD_DEPENDENCIES(${EXE_NAME} ${KLAYGE_CORELIB_NAME})

TARGET_LINK_LIBRARIES(${EXE_NAME} ${EXTRA_LINKED_LIBRARIES})

ADD_POST_BUILD(${EXE_NAME} "")

INSTALL(TARGETS ${EXE_NAME}
	RUNTIME DESTINATION ${KLAYGE_BIN_DIR}
	LIBRARY DESTINATION ${KLAYGE_BIN_DIR}
	ARCHIVE DESTINATION ${KLAYGE_OUTPUT_DIR}
)

CREATE_PROJECT_USERFILE(KlayGE ${EXE_NAME})

SET_TARGET_PROPERTIES(${EXE_NAME} PROPERTIES FOLDER "Tests")
