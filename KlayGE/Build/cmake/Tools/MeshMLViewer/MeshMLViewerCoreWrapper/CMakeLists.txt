SET(SOURCE_FILES 
	${KLAYGE_PROJECT_DIR}/Tools/src/MeshMLViewer/MeshMLViewerCoreWrapper/AssemblyInfo.cpp
	${KLAYGE_PROJECT_DIR}/Tools/src/MeshMLViewer/MeshMLViewerCoreWrapper/MeshMLViewerCoreWrapper.cpp
)

SET(HEADER_FILES 
	${KLAYGE_PROJECT_DIR}/Tools/src/MeshMLViewer/MeshMLViewerCoreWrapper/MeshMLViewerCoreWrapper.hpp
)

SOURCE_GROUP("Source Files" FILES ${SOURCE_FILES})
SOURCE_GROUP("Header Files" FILES ${HEADER_FILES})

INCLUDE_DIRECTORIES(${Boost_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../KFL/include)
INCLUDE_DIRECTORIES(${KLAYGE_PROJECT_DIR}/Core/Include)
LINK_DIRECTORIES(${Boost_LIBRARY_DIR})
LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../KFL/lib/${KLAYGE_PLATFORM_NAME})
LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/lib/${KLAYGE_PLATFORM_NAME})
LINK_DIRECTORIES(${MESHML_VIEWER_CORE_LIB_OUTPUT_DIR})

STRING(REPLACE "/RTC1" "" CMAKE_CXX_FLAGS_DEBUG ${CMAKE_CXX_FLAGS_DEBUG})
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /clr /EHa")
SET(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} /GR")
SET(CMAKE_CXX_FLAGS_RELWITHDEBINFO "${CMAKE_CXX_FLAGS_RELWITHDEBINFO} /GR")
SET(CMAKE_CXX_FLAGS_MINSIZEREL "${CMAKE_CXX_FLAGS_MINSIZEREL} /GR")
IF(MSVC_VERSION GREATER 1600)
	SET(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} /Qpar-")
	SET(CMAKE_CXX_FLAGS_RELWITHDEBINFO "${CMAKE_CXX_FLAGS_RELWITHDEBINFO} /Qpar-")
	SET(CMAKE_CXX_FLAGS_MINSIZEREL "${CMAKE_CXX_FLAGS_MINSIZEREL} /Qpar-")
ENDIF()
SET(CMAKE_SHARED_LINKER_FLAGS "${CMAKE_SHARED_LINKER_FLAGS} /ignore:4248")
ADD_LIBRARY(MeshMLViewerCoreWrapper SHARED ${SOURCE_FILES} ${HEADER_FILES})

SET_TARGET_PROPERTIES(MeshMLViewerCoreWrapper PROPERTIES
	PROJECT_LABEL MeshMLViewerCoreWrapper
	DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX}
	OUTPUT_NAME MeshMLViewerCoreWrapper
	VS_DOTNET_TARGET_FRAMEWORK_VERSION "v4.5"
	VS_DOTNET_REFERENCES "System;System.Windows;PresentationCore"
)
ADD_DEPENDENCIES(MeshMLViewerCoreWrapper MeshMLViewerCore)

TARGET_LINK_LIBRARIES(MeshMLViewerCoreWrapper
	debug MeshMLViewerCore_d optimized MeshMLViewerCore)

ADD_POST_BUILD(MeshMLViewerCoreWrapper "")

INSTALL(TARGETS MeshMLViewerCoreWrapper
	RUNTIME DESTINATION ${KLAYGE_BIN_DIR}
	LIBRARY DESTINATION ${KLAYGE_BIN_DIR}
	ARCHIVE DESTINATION ${MESHML_VIEWER_CORE_LIB_OUTPUT_DIR}
)

SET_TARGET_PROPERTIES(MeshMLViewerCoreWrapper PROPERTIES FOLDER "Tools/MeshMLViewer")
