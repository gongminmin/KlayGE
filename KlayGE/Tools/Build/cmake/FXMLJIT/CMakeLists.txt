SET(HEADER_FILES
	${KLAYGE_PROJECT_DIR}/Tools/src/FXMLJIT/OfflineD3D11ShaderObject.hpp
	${KLAYGE_PROJECT_DIR}/Tools/src/FXMLJIT/OfflineOGLESShaderObject.hpp
	${KLAYGE_PROJECT_DIR}/Tools/src/FXMLJIT/OfflineOGLShaderObject.hpp
	${KLAYGE_PROJECT_DIR}/Tools/src/FXMLJIT/OfflineRenderEffect.hpp
	${KLAYGE_PROJECT_DIR}/Tools/src/FXMLJIT/OfflineShaderObject.hpp
)

SET(SOURCE_FILES
	${KLAYGE_PROJECT_DIR}/Tools/src/FXMLJIT/FXMLJIT.cpp
	${KLAYGE_PROJECT_DIR}/Tools/src/FXMLJIT/OfflineD3D11ShaderObject.cpp
	${KLAYGE_PROJECT_DIR}/Tools/src/FXMLJIT/OfflineOGLESShaderObject.cpp
	${KLAYGE_PROJECT_DIR}/Tools/src/FXMLJIT/OfflineOGLShaderObject.cpp
	${KLAYGE_PROJECT_DIR}/Tools/src/FXMLJIT/OfflineRenderEffect.cpp
	${KLAYGE_PROJECT_DIR}/Tools/src/FXMLJIT/OfflineShaderObject.cpp
)

IF(KLAYGE_PLATFORM_DARWIN OR KLAYGE_PLATFORM_LINUX)
	FIND_PATH(WINE_PATH "winegcc" #searching for 'wine' may result in include path
		PATHS /usr/local/bin opt/local/sbin /usr/bin /bin /usr/sbin /sbin /usr/local/bin)

	IF(NOT WINE_PATH)
		MESSAGE(FATAL_ERROR "Cound NOT find wine")
	ENDIF()
	ADD_DEFINITIONS(-DWINE_PATH="\\"${WINE_PATH}/\\"")
ENDIF()

STRING(FIND "${CMAKE_GENERATOR_TOOLSET}" "_xp" IS_XP_TOOLSET)
SET(USE_DX_SDK FALSE)
IF(MSVC)
	IF(MSVC_VERSION LESS 1699)
		SET(USE_DX_SDK TRUE)
	ELSEIF(NOT (${IS_XP_TOOLSET} LESS 0))
		SET(USE_DX_SDK TRUE)
	ENDIF()
ELSE()
	SET(USE_DX_SDK TRUE)
ENDIF()

IF(NOT MSVC)
	SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wno-unknown-pragmas -Wno-comment -Wno-switch")
ENDIF()

SET(EXTRA_INCLUDE_DIRS ${EXTRA_INCLUDE_DIRS}
	${KLAYGE_PROJECT_DIR}/Plugins/Include
	${KLAYGE_PROJECT_DIR}/../glloader/include
	${KLAYGE_PROJECT_DIR}/../DXBC2GLSL/Include)
IF(USE_DX_SDK)
	SET(EXTRA_INCLUDE_DIRS ${EXTRA_INCLUDE_DIRS}
		${KLAYGE_PROJECT_DIR}/../External/DXSDK/Include)
ENDIF()
SET(EXTRA_LINKED_DIRS ${EXTRA_LINKED_DIRS}
	${KLAYGE_PROJECT_DIR}/../DXBC2GLSL/lib/${KLAYGE_PLATFORM_NAME})
IF(MSVC)
	SET(EXTRA_LINKED_LIBRARIES ${EXTRA_LINKED_LIBRARIES})
ELSE()
	SET(EXTRA_LINKED_LIBRARIES ${EXTRA_LINKED_LIBRARIES}
		debug DXBC2GLSLLib${KLAYGE_OUTPUT_SUFFIX}_d optimized DXBC2GLSLLib${KLAYGE_OUTPUT_SUFFIX}
		${Boost_FILESYSTEM_LIBRARY})
ENDIF()

SETUP_TOOL(FXMLJIT)
