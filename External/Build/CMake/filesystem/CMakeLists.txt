if(KLAYGE_COMPILER_MSVC
	OR KLAYGE_COMPILER_CLANGCL
	OR (KLAYGE_COMPILER_GCC AND (NOT KLAYGE_PLATFORM_WINDOWS OR NOT (KLAYGE_COMPILER_VERSION EQUAL 81)))
	OR (KLAYGE_COMPILER_CLANG AND (((KLAYGE_PLATFORM_WINDOWS OR KLAYGE_PLATFORM_LINUX) AND (KLAYGE_COMPILER_VERSION GREATER_EQUAL 70)) OR (KLAYGE_PLATFORM_ANDROID AND (KLAYGE_COMPILER_VERSION GREATER_EQUAL 110)))))
	set(WITH_FILESYSTEM OFF)
else()
	set(WITH_FILESYSTEM ON)
endif()

set(KLAYGE_WITH_GHC_FILESYSTEM ${WITH_FILESYSTEM} CACHE INTERNAL "" FORCE)

if(NOT WITH_FILESYSTEM)
	return()
endif()

set(FILESYSTEM_PROJECT_DIR "${EXTERNAL_PROJECT_DIR}/filesystem")

UpdateExternalLib("filesystem" "https://github.com/gulrak/filesystem.git" "1edf4a333930f126f5dcd2f7919f0bf4fa3acecc")

set(GHC_FILESYSTEM_BUILD_EXAMPLES OFF CACHE BOOL "" FORCE)
set(GHC_FILESYSTEM_BUILD_TESTS OFF CACHE BOOL "" FORCE)
set(GHC_FILESYSTEM_WITH_INSTALL OFF CACHE BOOL "" FORCE)

add_subdirectory(${FILESYSTEM_PROJECT_DIR} "${CMAKE_CURRENT_BINARY_DIR}/filesystem" EXCLUDE_FROM_ALL)
