SET(GOOGLETEST_PROJECT_DIR "${EXTERNAL_PROJECT_DIR}/googletest")
SET(GOOGLETEST_OUTPUT_DIR "${EXTERNAL_PROJECT_DIR}/lib/googletest/${KLAYGE_PLATFORM_NAME}")

set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${GOOGLETEST_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_DEBUG ${GOOGLETEST_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RELEASE ${GOOGLETEST_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RELWITHDEBINFO ${GOOGLETEST_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_MINSIZEREL ${GOOGLETEST_OUTPUT_DIR})

UpdateExternalLib("googletest" "https://github.com/google/googletest.git" "e649993a402d96afe25fbf3413749adf0f2947f6")

set(BUILD_GMOCK OFF CACHE BOOL "" FORCE)
set(INSTALL_GTEST OFF CACHE BOOL "" FORCE)
set(BUILD_SHARED_LIBS OFF CACHE BOOL "" FORCE)
set(gtest_disable_pthreads ON CACHE BOOL "" FORCE)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

ADD_SUBDIRECTORY("${GOOGLETEST_PROJECT_DIR}" "${CMAKE_CURRENT_BINARY_DIR}/googletest" EXCLUDE_FROM_ALL)

SET_TARGET_PROPERTIES(gtest PROPERTIES
	OUTPUT_NAME gtest${KLAYGE_OUTPUT_SUFFIX}
	FOLDER "${EXTERNAL_VS_FOLDER_PREFIX}/googletest"
)
set_property(TARGET gtest PROPERTY PDB_OUTPUT_DIRECTORY)
