SET(LIB_NAME LibOpenJPEG)

SET(LIBOPENJPEG_SOURCE_FILES
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/bio.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/cio.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/dwt.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/event.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/function_list.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/image.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/invert.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/j2k.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/jp2.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/mct.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/mqc.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/openjpeg.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/opj_clock.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/pi.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/raw.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/t1.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/t2.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/tcd.c
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/tgt.c
)
SET(LIBOPENJPEG_HEADER_FILES
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/bio.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/cio.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/dwt.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/event.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/function_list.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/image.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/indexbox_manager.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/invert.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/j2k.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/jp2.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/mct.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/mqc.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/openjpeg.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/opj_clock.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/opj_config.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/opj_config_private.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/opj_includes.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/opj_intmath.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/opj_inttypes.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/opj_malloc.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/opj_stdint.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/pi.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/raw.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/t1.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/t1_luts.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/t2.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/tcd.h
	${FREEIMAGE_PROJECT_DIR}/Source/LibOpenJPEG/tgt.h
)
SOURCE_GROUP("Source Files" FILES ${LIBOPENJPEG_SOURCE_FILES})
SOURCE_GROUP("Header Files" FILES ${LIBOPENJPEG_HEADER_FILES})

ADD_LIBRARY(${LIB_NAME} STATIC
	${LIBOPENJPEG_SOURCE_FILES} ${LIBOPENJPEG_HEADER_FILES}
)

target_compile_definitions(${LIB_NAME}
	PRIVATE
		-DOPJ_STATIC
)
if(KLAYGE_PLATFORM_WINDOWS)
	target_compile_definitions(${LIB_NAME}
		PRIVATE
			-D_CRT_SECURE_NO_DEPRECATE
	)
endif()

SET_TARGET_PROPERTIES(${LIB_NAME} PROPERTIES
	ARCHIVE_OUTPUT_DIRECTORY ${FREEIMAGE_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_DEBUG ${FREEIMAGE_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_RELEASE ${FREEIMAGE_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_RELWITHDEBINFO ${FREEIMAGE_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_MINSIZEREL ${FREEIMAGE_OUTPUT_DIR}
	PROJECT_LABEL ${LIB_NAME}
	DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX}
	OUTPUT_NAME ${LIB_NAME}${KLAYGE_OUTPUT_SUFFIX}
)

TARGET_LINK_LIBRARIES(${LIB_NAME})
