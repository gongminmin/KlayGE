SET(FREETYPE_PROJECT_DIR "${EXTERNAL_PROJECT_DIR}/freetype")
SET(FREETYPE_OUTPUT_DIR "${EXTERNAL_PROJECT_DIR}/lib/freetype/${KLAYGE_PLATFORM_NAME}")

set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${FREETYPE_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_DEBUG ${FREETYPE_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RELEASE ${FREETYPE_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RELWITHDEBINFO ${FREETYPE_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_MINSIZEREL ${FREETYPE_OUTPUT_DIR})

UpdateExternalLib("freetype" "https://git.savannah.nongnu.org/r/freetype/freetype2.git/" "6a2b3e4007e794bfc6c91030d0ed987f925164a8")

SET(BUILD_SHARED_LIBS OFF CACHE BOOL "" FORCE)
set(SKIP_INSTALL_ALL ON CACHE BOOL "" FORCE)
SET(FT_WITH_BROTLI OFF CACHE BOOL "" FORCE)
SET(FT_WITH_ZLIB OFF CACHE BOOL "" FORCE)
SET(FT_WITH_BZIP2 OFF CACHE BOOL "" FORCE)
SET(FT_WITH_PNG OFF CACHE BOOL "" FORCE)
SET(FT_WITH_HARFBUZZ OFF CACHE BOOL "" FORCE)
SET(CMAKE_DISABLE_FIND_PACKAGE_BrotliDec TRUE CACHE BOOL "" FORCE)
SET(CMAKE_DISABLE_FIND_PACKAGE_BZip2 TRUE CACHE BOOL "" FORCE)
SET(CMAKE_DISABLE_FIND_PACKAGE_PNG TRUE CACHE BOOL "" FORCE)
SET(CMAKE_DISABLE_FIND_PACKAGE_HarfBuzz TRUE CACHE BOOL "" FORCE)

ADD_SUBDIRECTORY(${FREETYPE_PROJECT_DIR} "${CMAKE_CURRENT_BINARY_DIR}/freetype")

if(KLAYGE_COMPILER_CLANGCL)
	target_compile_options(freetype
		PRIVATE
			-Wno-unused-parameter
	)
endif()

SET_TARGET_PROPERTIES(freetype PROPERTIES
	DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX}
	OUTPUT_NAME freetype${KLAYGE_OUTPUT_SUFFIX}
	FOLDER "${EXTERNAL_VS_FOLDER_PREFIX}/freetype"
)

add_dependencies(freetype ${KLAYGE_ZLIB_NAME})
